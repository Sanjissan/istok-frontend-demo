:root{
  --bg:#070812;
  --bg2:#0b0c18;
  --card:#0b0c18;
  --ink:#ffffff;
  --muted:rgba(255,255,255,.72);
  --muted2:rgba(255,255,255,.55);
  --line:rgba(255,255,255,.10);
  --line2:rgba(255,255,255,.14);
  --accent:#6f8cff;
  --accent2:#4d6bff;
  --shadow:0 18px 50px rgba(0,0,0,.55);
  --r:18px;
}

*{box-sizing:border-box}
html,body{height:100%}

body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color:var(--ink);
background: linear-gradient(180deg, var(--bg), var(--bg2));
overflow: hidden;

}

/* ---------- Top bar (DH12-like) ---------- */
.topbar{
  position:sticky;
  top:0;
  z-index:200;
  height:72px;
  padding:0 16px;
  display:grid;
  grid-template-columns: 1fr 1.2fr 1fr;
  align-items:center;
  gap:12px;
  border-bottom:1px solid var(--line);
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0));
  backdrop-filter: blur(10px);
}

.zoom-controls{display:flex;align-items:center;gap:6px;margin-left:6px}
.zbtn{
  height:34px;min-width:34px;
  padding:0 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.18);
  color:rgba(255,255,255,.88);
  font-weight:1000;
  cursor:pointer;
}
.zbtn:hover{border-color:rgba(111,140,255,.35)}
.zlabel{min-width:46px;text-align:right;font-weight:1000;color:rgba(255,255,255,.72);font-size:12px}

.top-left{display:flex;align-items:center;gap:12px;min-width:260px}
.top-center{display:flex;justify-content:center}
.top-right{display:flex;justify-content:flex-end;align-items:center;gap:12px}

.dh-pill{
  height:34px;
  padding:0 10px;
  border-radius:999px;
  border:1px solid var(--line);
  background:rgba(0,0,0,.18);
  display:flex;align-items:center;
}
.dhSelect{
  height:30px;
  border:none;
  background:transparent;
  color:var(--ink);
  font-weight:900;
  outline:none;
  appearance:none;
  padding-right:18px;
  cursor:pointer;
}
.dh-pill::after{
  content:"â–¾";
  font-size:12px;
  color:rgba(255,255,255,.6);
  margin-left:-14px;
  pointer-events:none;
}

.tabs{
  height:34px;
  padding:4px;
  border-radius:12px;
  border:1px solid var(--line);
  background:rgba(0,0,0,.18);
  display:flex;
  gap:6px;
}
.tab{
  height:26px;
  padding:0 12px;
  border-radius:9px;
  border:1px solid transparent;
  background:transparent;
  color:var(--muted);
  font-weight:900;
  font-size:12px;
  cursor:pointer;
}
.tab.active{
  background:rgba(111,140,255,.20);
  border-color:rgba(111,140,255,.34);
  color:var(--ink);
}

.search{
  width:min(560px, 100%);
  height:40px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.18);
  display:flex;
  align-items:center;
  gap:10px;
  padding:0 12px;
}
.search-ico{color:rgba(255,255,255,.65);font-weight:900}
.search-input{
  width:100%;
  border:none;
  outline:none;
  background:transparent;
  color:var(--ink);
  font-weight:800;
}

/* Sidebar variant */
.search.search-side{
  width:100%;
  height:36px;
  border-radius:12px;
  margin-top:12px;
}
.search.search-side .search-input{
  font-weight:700;
}

.toggle{display:flex;align-items:center;gap:10px;cursor:pointer;user-select:none}
.toggle input{display:none}
.toggle-ui{
  width:38px;height:22px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.22);
  position:relative;
  transition: all .15s ease;
}
.toggle-ui::after{
  content:"";
  width:16px;height:16px;
  border-radius:999px;
  background:rgba(255,255,255,.75);
  position:absolute;
  left:3px;top:2px;
  transition: all .15s ease;
}
.toggle input:checked + .toggle-ui{
  background:rgba(111,140,255,.25);
  border-color:rgba(111,140,255,.35);
}
.toggle input:checked + .toggle-ui::after{left:18px;background:rgba(255,255,255,.95)}
.toggle-text{font-weight:900;font-size:12px;color:rgba(255,255,255,.8)}

/* ---------- Layout ---------- */
.page{
  height:calc(100vh - 72px);
  padding:14px;
  display:grid;
  grid-template-columns: 1fr 420px;
  gap:12px;
  overflow:hidden;
}

@media (max-width:1200px){
  body{overflow:auto}
  .topbar{grid-template-columns:1fr; height:auto; padding:12px; row-gap:10px}
  .top-center{justify-content:stretch}
  .page{grid-template-columns:1fr;height:auto;overflow:visible}
}

/* ---------- Right panel ---------- */
.panel{
  border-radius:var(--r);
  border:1px solid var(--line);
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  box-shadow:var(--shadow);
  padding:14px;
  overflow:auto;
}

.panel-head{padding:6px 4px 10px 4px;border-bottom:1px solid rgba(255,255,255,.06);margin-bottom:10px}
.panel-title{font-weight:1000;letter-spacing:.3px}
.panel-sub{margin-top:4px;color:var(--muted2);font-weight:900;font-size:12px}

.panel-section{padding:10px 4px}
.section-title{font-weight:1000;margin-bottom:10px}

.bars{display:flex;flex-direction:column;gap:10px;margin-top:10px}
.bar-row{display:grid;grid-template-columns: 110px 1fr 52px;align-items:center;gap:10px}
.bar-label{font-size:11px;font-weight:1000;color:rgba(255,255,255,.75)}
.bar-track{height:8px;border-radius:999px;background:rgba(255, 255, 255, 0.1);border:1px solid rgba(255,255,255,.10);overflow:hidden}
.bar-fill{height:100%;border-radius:999px;background:rgba(255,255,255,.75)}
.bar-pct{font-size:11px;font-weight:1000;color:rgba(255,255,255,.75);text-align:right}

.group{margin-top:12px}
.label{color:var(--muted2);font-size:12px;margin-bottom:6px;font-weight:900}
.subgroup{margin-top:12px}

.select{
  width:100%;
  height:40px;
  border-radius:12px;
  border:1px solid var(--line);
  background:rgba(0,0,0,.18);
  color:var(--ink);
  padding:0 10px;
  font-weight:900;
}
.hint{margin-top:8px;color:rgba(255,255,255,.55);font-size:12px;font-weight:800}

/* Hide helper text blocks in the right panel (keeps layout clean).
   We still keep the elements in DOM so JS bindings don't break. */
.panel .hint{display:none}

.textarea{
  width:100%;
  min-height:110px;
  border-radius:12px;
  border:1px solid var(--line);
  background:rgba(0,0,0,.18);
  color:var(--ink);
  padding:10px;
  font-weight:800;
  resize:vertical;
}

.btn-primary{
  width:100%;
  height:40px;
  border-radius:12px;
  border:1px solid rgba(111,140,255,.35);
  background:rgba(111,140,255,.28);
  color:rgba(240,245,255,.98);
  font-weight:1000;
  cursor:pointer;
}
.btn-primary:disabled{opacity:.55;cursor:not-allowed}
.btn-primary:hover{filter:brightness(1.05)}

.selected{
  border-radius:14px;border:1px solid var(--line);
  background:rgba(0,0,0,.12);
  padding:12px;
}
.selected-title{font-weight:1000}
.selected-sub{color:var(--muted2);font-size:12px;margin-top:4px;font-weight:900}
.selected-actions{display:flex;justify-content:flex-end;margin-top:10px}

.btn-ghost{
  height:36px;
  padding:0 12px;
  border-radius:12px;
  border:1px solid var(--line2);
  background:rgba(0,0,0,.18);
  color:var(--ink);
  font-weight:1000;
  cursor:pointer;
}
.btn-ghost:hover{filter:brightness(1.05)}

/* --- Responsible modal --- */
.pt-modal{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  padding:20px;
  background:rgba(0,0,0,.45);
  z-index:9999;
}

.pt-modal.open{display:flex}

.pt-modal-card{
  width:min(420px, 95vw);
  border-radius:16px;
  border:1px solid var(--line);
  background:rgba(18,20,28,.98);
  box-shadow:0 18px 60px rgba(0,0,0,.55);
  padding:16px;
}

.pt-modal-title{
  font-weight:1000;
  margin-bottom:12px;
}

.pt-modal-body{margin-bottom:14px}

.pt-modal-actions{
  display:flex;
  gap:10px;
  justify-content:flex-end;
}

.pt-modal-actions .btn-primary{width:auto; padding:0 16px}

/* ---------- Map card ---------- */
.map-card{
  border-radius:var(--r);
  border:1px solid var(--line);
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  box-shadow:var(--shadow);
  overflow:hidden;
  min-width:0;
  display:flex;
  flex-direction:column;
}

.map-header{
  padding:12px 14px;
  border-bottom:1px solid var(--line);
  background:rgba(0,0,0,.10);
  display:flex;
  flex-direction:column;
  gap:12px;
}
.map-header-top{display:flex;align-items:center;justify-content:space-between;gap:10px}
.map-title{font-weight:1000}

.top-actions{display:flex;align-items:center;gap:10px}
.chip{
  height:34px;padding:0 12px;border-radius:999px;
  border:1px solid var(--line);
  background:rgba(0,0,0,.18);
  display:inline-flex;align-items:center;
  color:var(--muted);
  font-weight:1000;font-size:12px;
}
.chip-ghost{border-color:rgba(111,140,255,.28);color:rgba(230,238,255,.92)}

.map-header-bottom{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.process-chips{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
.pchip{
  height:28px;
  padding:0 10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.18);
  color:rgba(255,255,255,.78);
  font-weight:1000;
  font-size:11px;
  cursor:pointer;
  white-space:nowrap;
}
.pchip.active{
  background:rgba(111,140,255,.22);
  border-color:rgba(111,140,255,.35);
  color:rgba(255,255,255,.95);
}

.map-scroll{
  flex:1;
  min-height:0;
  padding:12px;
  overflow:auto;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: thin;
  scrollbar-color: rgba(111,140,255,.45) rgba(0,0,0,.18);
}

.map-scroll::-webkit-scrollbar{width:10px;height:10px}
.map-scroll::-webkit-scrollbar-track{
  background:rgba(0,0,0,.18);
  border-radius:999px;
  margin:10px;
}
.map-scroll::-webkit-scrollbar-thumb{
  background:rgba(111,140,255,.35);
  border-radius:999px;
  border:2px solid rgba(0,0,0,.18);
}
.map-scroll::-webkit-scrollbar-thumb:hover{background:rgba(111,140,255,.55)}

.matrix-zoom{display:inline-block;}

/* ---------- Matrix ---------- */
.matrix{
  min-width:1500px;
  display:grid;
  gap:14px;
}

.matrix-row{
  display:grid;
  grid-template-columns: 92px repeat(13, minmax(92px, 1fr)) 92px;
  gap:8px;
  align-items:stretch;
}

.matrix-head{position:sticky;top:0;z-index:5;background:rgba(7,8,18,.85);backdrop-filter: blur(10px);padding:6px 0;border-radius:12px;border:1px solid rgba(255,255,255,.05)}

.corner{width:92px}

.rowh{
  text-align:center;
  font-size:11px;
  font-weight:1000;
  color:rgba(255,255,255,.65);
  padding:8px 6px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.06);
  background:rgba(0,0,0,.10);
}

.lu-label{
  text-align:center;
  font-weight:1000;
  color:rgba(255,255,255,.85);
  padding:10px 8px;
  background:rgba(0,0,0,.12);
  display:flex;
  align-items:center;
  justify-content:center;
}
.lu-right{opacity:.55}

.cell{
  border-radius:14px;
  border:1px solid rgb(255, 255, 255);
  background:rgba(0,0,0,.10);
  min-height:64px;
  display:flex;
  align-items:stretch;
  flex-direction:column;
  gap:6px;
  padding:6px;
}

.su{
  width:100%;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.08);
  padding:10px 10px;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-weight:1000;
  font-size:11px;
  color:rgba(255,255,255,.90);
  line-height:1.1;
  user-select:none;
}

/* hover */
.su:hover{filter:brightness(1.06)}

.cell{
  position: relative;
  box-sizing: border-box;
}

.textlabel{
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  writing-mode: vertical-rl;
  text-orientation: mixed;

  padding: 0;
  border: none;
  background: none;
  border-radius: 0;
  box-shadow: none;
  backdrop-filter: none;

  font-weight: 900;
  font-size: 13px;
  letter-spacing: .4px;
  color: #ffffff;

  text-shadow:
    0 0 2px rgba(0,0,0,.8),
    0 0 6px rgba(0,0,0,.6);

  pointer-events: none;
  white-space: nowrap;
}


.cell.label-right{
  padding-right: 44px;
}
.cell.label-right .textlabel{
  right: 8px;
  left: auto;
}

.cell.label-left{
  padding-left: 44px;
}
.cell.label-left .textlabel{
  left: 8px;
  right: auto;
  transform: translateY(-50%) rotate(180deg);
}
.cell.multi3 .textlabel { top: auto; transform: translateY(-50%); }

.cell.multi3 .textlabel:nth-of-type(1){ top: 22%; }
.cell.multi3 .textlabel:nth-of-type(2){ top: 50%; }
.cell.multi3 .textlabel:nth-of-type(3){ top: 78%; }

.cell.label-left.multi3 .textlabel{
  transform: translateY(-50%) rotate(180deg);
}
